<nav class="bg-white flex items-center justify-between px-6 py-4 relative">
  <div class="flex items-center space-x-4">
    <%= image_tag "WhiteUSF.png", alt: "University of South Florida", class: "h-10 w-auto" %> 
  </div>

  <h1 class="absolute left-1/2 transform -translate-x-1/2 text-white font-bold text-xl">
    Ride Request
  </h1>

  <div class="flex items-center space-x-4">
    <%= link_to "New Ride", new_ride_request_path, class: "text-[#006747] hover:underline font-semibold" %>
    <%= link_to "Ride History", ride_requests_path, method: :delete, class: "text-[#006747] hover:underline font-semibold" %>
    <% if current_user&.admin? %>
      <%= link_to "Admin Dashboard", admin_dashboard_path, class: "text-[#006747] hover:underline font-semibold" %>
    <% end %>
    <%= link_to "Log Out", logout_path, method: :delete, class: "text-[#006747] hover:underline font-semibold" %>
  </div>
</nav>

<div class="min-h-screen flex items-center justify-center" style="background-color: #006747;">
  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">

    
    <h1 class="text-xl font-bold underline text-green-800 mb-6 text-left">Enter Your Information</h1>

    
    <% if @ride_request.errors.any? %>
      <div class="text-red-600 mb-4 text-sm">
        <h2 class="font-semibold"><%= pluralize(@ride_request.errors.count, "error") %> prohibited this form from being saved:</h2>
        <ul class="list-disc list-inside">
          <% @ride_request.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    
    <% if flash[:alert] %>
      <p class="text-red-600 font-bold mb-4 text-sm"><%= flash[:alert] %></p>
    <% end %>

    
    <%= form_with model: @ride_request, local: true, data: { turbo: false } do |f| %>
      <div class="space-y-4">

        <div>
          <%= f.label :number_of_passengers, "Number of Passengers:", class: "text-green-800 font-semibold text-sm" %>
          <%= f.text_field :number_of_passengers,
            inputmode: "numeric",
            class: "w-full px-3 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-black text-sm",
            id: "passenger-count" %>
        </div>

        <p id="passenger-warning" class="text-yellow-500 font-bold text-xs hidden"></p>

        <div>
          <%= f.label :name, "Name:", class: "text-green-800 font-semibold text-sm" %>
          <%= f.text_field :name, class: "w-full px-3 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-black text-sm" %>
        </div>

        <div>
          <%= f.label :phone, "Phone Number:", class: "text-green-800 font-semibold text-sm" %>
          <%= f.text_field :phone, class: "w-full px-3 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-black text-sm" %>
        </div>

        <div>
          <%= f.label :location, "Your Location:", class: "text-green-800 font-semibold text-sm" %>
          <%= f.select :location, building_dropdown,
            prompt: "Select Your Location",
            class: "w-full px-3 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-black text-sm appearance-none" %>
        </div>

        <div>
          <%= f.label :destination, "Destination:", class: "text-green-800 font-semibold text-sm" %>
          <%= f.select :destination, building_dropdown,
            prompt: "Select Your Destination",
            class: "w-full px-3 py-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-black text-sm appearance-none" %>
        </div>

        <!-- Submit Button -->
        <div class="pt-4">
          <%= f.submit "Submit", class: "w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 rounded-md text-sm transition duration-300" %>
        </div>

      </div>
    <% end %>


  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const countInput = document.getElementById("passenger-count");
      const submitButton = document.querySelector("input[type='submit']");
      const warningMessage = document.getElementById("passenger-warning");

      function validateInput() {
        const value = countInput.value.trim();
        const count = parseInt(value, 10);

        if (!/^\d+$/.test(value) || isNaN(count) || count == 0) {
          warningMessage.textContent = "Please enter a valid number.";
          warningMessage.classList.remove("text-yellow-500");
          warningMessage.classList.add("text-red-500");
          warningMessage.classList.remove("hidden");
          submitButton.disabled = true;
          submitButton.classList.add("opacity-50", "cursor-not-allowed");
        } else if (count > 2) {
          warningMessage.textContent = "For parties larger than 2, please call 813-974-SAFE (7233).";
          warningMessage.classList.remove("text-red-500");
          warningMessage.classList.add("text-yellow-500");
          warningMessage.classList.remove("hidden");
          submitButton.disabled = true;
          submitButton.classList.add("opacity-50", "cursor-not-allowed");
        } else {
          warningMessage.classList.add("hidden");
          submitButton.disabled = false;
          submitButton.classList.remove("opacity-50", "cursor-not-allowed");
        }
      }

      countInput.addEventListener("input", validateInput);
    });
  </script>
</div>
